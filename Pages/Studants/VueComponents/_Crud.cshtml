@{Html.RenderPartial("~/Pages/VueComponents/_CrudModal.cshtml");}



<script type="text/javascript">

    Vue.component('vue-studant-crud', {
        id:'studant-crud',
        model: {
            prop: 'show',
            event: 'change-show'
        },
        props: {
            data: {
                type: Object,
                default: () => {}
            },
            operation: null,
            show: false,
        },
        data() {
            return {
                path: '/Studants',
                form: {},
            }
        },
        template: '#vue-alunos-crud-template',
        methods: {
            propagateShowEvent: function(value) {
                this.$emit('change-show', value)
            },
            propagateUpdateEvent: function(value) {
                this.$emit('update', value)
                this.propagateChangeDataEvent()
            },
            propagateCreateEvent: function(value) {
                this.$emit('create', value)
                this.propagateChangeDataEvent()
            },
            propagateDeleteEvent: function(value) {
                this.$emit('delete', value)
                this.propagateChangeDataEvent()
            },
            propagateResetEvent: function(value) {
                this.$emit('reset', value)
            },
            propagateChangeDataEvent: function(value) {
                this.$emit('change-data')
            },
            delete(id) {
                this.form.id = id
                this.$refs.crud.delete()
            },
            clearForm() {
                this.form = {
                    'id': null,
                    'name': '',
                    'averageScore': 0
                }
            }
        },
        computed: {
          crudModalListeners: function() {
            let vm = this
            return {
              "change-show": function(value) {
                  vm.propagateShowEvent(value)
              },
              reset: function(value) {
                  vm.propagateResetEvent(value)
              },
              update: function(value) {
                  vm.propagateUpdateEvent(value)
              },
              create: function(value) {
                  vm.propagateCreateEvent(value)
              },
              delete: function(value) {
                  vm.propagateDeleteEvent(value)
              }
            }
          }
        },
        watch: {
            operation(value) {
                if (value == 'create') {
                    this.clearForm()
                } else {
                    this.form = this.data
                }
            },
            data(value) {
                if (this.operation == 'update' && hasValue(value)) {
                    this.form = value
                } else{
                    this.clearForm()
                } 
            }
        }
    });
</script>

<script type="text/template" id="vue-alunos-crud-template">
    <vue-crud-modal
        ref="crud"
        :id="'studant-crud-modal'"
        :title-create="'New studant'"
        :title-update="'Edit studant'"
        :path="path"
        :form="form"
        :show="show"
        :operation="operation"
        v-on="crudModalListeners">

        <b-form-group id="input-group-1" label="Name:" label-for="input-1">
            <b-form-input
                id="input-1"
                v-model="form.name"
                placeholder="Enter with a studant name"
                required>
            </b-form-input>
        </b-form-group>

        <b-form-group id="input-group-2" label="Average Score:" label-for="input-2">
            <b-form-input
                id="input-2"
                v-model="form.averageScore"
                type="number"
                min=0
                max=100
                :step="0.01"
                :no-wheel="true"
                placeholder="Enter with a studant average score"
                required>
            </b-form-input>
        </b-form-group>
    </vue-crud-modal>
</script>

